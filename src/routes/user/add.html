<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <script>
        function ajax(option, callback) {
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if(this.readyState !== 4) return;
                if(this.status === 200) {
                    callback(null, this.responseText);
                }
                else {
                    callback(this.statusText);
                }
            }
            xhr.open(option.method, option.url);
            if(option.data) {
                xhr.setRequestHeader('content-type', 'application/json');
            }
            xhr.send(option.data ? JSON.stringify(option.data) : undefined);
        }
    </script>
    </head>
    <body>
        <form action>
            <input type="text" name="username" placeholder="username"><br/>
            <input type="text" name="password" placeholder="password"><br/>
            <input type="text" name="mail" placeholder="mail"><br/>
            <input type="text" name="code" placeholder="code"><br/>
        </form>
        <button id="submit" style="margin:10px 0;">添加用户</button>
        <script>
        document.querySelector('#submit').onclick = function () {
            const form = document.querySelector('form');
            const {
                username,
                password,
                mail,
                code
            } = form;
            
            const data = {
                username: username.value,
                password: password.value,
                mail: mail.value,
                code: code.value
            };
           
            ajax({
                url: '/api/user/add',
                method: 'post',
                data
            }, (err, data) => {
                if(err) console.log(err);
                else console.log(data);
            });
        }          
    </script>
    </body>
</html>